<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CODE of 2026 SCIn</title>
  <style>
    :root { --primary: #a8dadc; --secondary: #f1faee; --accent: #457b9d; --dark: #1d3557; }
    body { font-family: 'Sarabun', sans-serif; background: var(--secondary); color: var(--dark); margin: 0; padding: 20px; display: flex; flex-direction: column; align-items: center; }
    .card { background: white; border-radius: 20px; padding: 25px; box-shadow: 0 10px 20px rgba(0,0,0,0.05); width: 100%; max-width: 400px; text-align: center; margin-bottom: 20px; }
    h2, h3 { color: var(--accent); margin-bottom: 15px; }
    input, select { width: 90%; padding: 12px; margin-bottom: 10px; border-radius: 10px; border: 1px solid #ddd; }
    .btn { width: 100%; padding: 15px; margin: 8px 0; border: none; border-radius: 12px; font-size: 16px; font-weight: bold; cursor: pointer; color: white; transition: 0.3s; }
    .btn-site { background: #ffb703; }
    .btn-start { background: #2a9d8f; }
    .btn-end { background: #e76f51; }
    .btn-exp { background: #6a4c93; }
    #preview { width: 100%; border-radius: 15px; margin-top: 15px; display: none; border: 1px solid #ddd; }
    .divider { height: 2px; background: #eee; margin: 20px 0; }
    #status { margin-top: 15px; font-weight: bold; font-size: 14px; }
  </style>
</head>
<body>

  <div class="card">
    <h2>CODE of 2026 SCIn</h2>
    <input type="text" id="userName" placeholder="üë§ ‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô">
    
    <button class="btn btn-site" onclick="triggerAction('SITE')">üìç Site Check In</button>
    <button class="btn btn-start" onclick="triggerAction('START')">üí™ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô</button>
    <button class="btn btn-end" onclick="triggerAction('END')">üò¥ ‡πÄ‡∏•‡∏¥‡∏Å‡∏á‡∏≤‡∏ô</button>

    <div class="divider"></div>

    <h3>üí∞ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢</h3>
    <select id="expType">
      <option value="‡∏Ñ‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á">üöó ‡∏Ñ‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á</option>
      <option value="‡∏Ñ‡πà‡∏≤‡∏≠‡∏≤‡∏´‡∏≤‡∏£">üç¥ ‡∏Ñ‡πà‡∏≤‡∏≠‡∏≤‡∏´‡∏≤‡∏£</option>
      <option value="‡∏ß‡∏±‡∏™‡∏î‡∏∏‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå">üõ†Ô∏è ‡∏ß‡∏±‡∏™‡∏î‡∏∏‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå</option>
      <option value="‡∏≠‡∏∑‡πà‡∏ô‡πÜ">üì¶ ‡∏≠‡∏∑‡πà‡∏ô‡πÜ</option>
    </select>
    <input type="number" id="expAmount" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô (‡∏ö‡∏≤‡∏ó)">
    <button class="btn btn-exp" onclick="triggerAction('EXPENSE')">üì∏ ‡∏ñ‡πà‡∏≤‡∏¢‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à & ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>

    <input type="file" id="cameraInput" accept="image/*" capture="camera" style="display:none;" onchange="handleImage(this)">
    <img id="preview">
    <div id="status">‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</div>
  </div>

  <script>
    const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbwk-spmOFdk-ZLRHhTkJXUshNWmJ6DqvdbNqUByszqLMDVujm7XFe0by-VDVUmNgZmuoQ/exec";
    let currentAction = "";
    let base64Image = "";

    function triggerAction(action) {
      const name = document.getElementById('userName').value;
      if (!name) return alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡∏Å‡πà‡∏≠‡∏ô‡∏Ñ‡∏£‡∏±‡∏ö");
      
      currentAction = action;
      document.getElementById('cameraInput').click();
    }

    function handleImage(input) {
      if (input.files && input.files[0]) {
        const reader = new FileReader();
        reader.onload = function(e) {
          base64Image = e.target.result;
          document.getElementById('preview').src = base64Image;
          document.getElementById('preview').style.display = "block";
          submitData();
        };
        reader.readAsDataURL(input.files[0]);
      }
    }

    function submitData() {
      const statusDiv = document.getElementById('status');
      const name = document.getElementById('userName').value;
      const expType = document.getElementById('expType').value;
      const expAmount = document.getElementById('expAmount').value;

      statusDiv.innerText = "‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...";
      statusDiv.style.color = "#f39c12";

      navigator.geolocation.getCurrentPosition(function(pos) {
        let values = [
          new Date().toLocaleString('th-TH'),
          name,
          currentAction,
          pos.coords.latitude,
          pos.coords.longitude,
          "GitHub Pages"
        ];

        // ‡∏´‡∏≤‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ö‡∏¥‡∏Å‡πÄ‡∏á‡∏¥‡∏ô ‡πÉ‡∏´‡πâ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡πÉ‡∏ô‡∏≠‡∏≤‡πÄ‡∏£‡∏¢‡πå (‡∏õ‡∏£‡∏±‡∏ö‡∏ï‡∏≤‡∏°‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á Column ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì)
        if(currentAction === "EXPENSE") {
          values.push(expType, expAmount);
        }

        fetch(WEB_APP_URL, {
          method: "POST",
          mode: "no-cors",
          body: JSON.stringify({
            action: currentAction,
            values: values,
            image: base64Image
          })
        }).then(() => {
          statusDiv.innerText = "‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!";
          statusDiv.style.color = "#27ae60";
          alert("‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å " + currentAction + " ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢");
          // Reset
          document.getElementById('preview').style.display = "none";
          document.getElementById('expAmount').value = "";
          base64Image = "";
        }).catch(err => {
          statusDiv.innerText = "‚ùå ‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: " + err;
        });

      }, (err) => alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏õ‡∏¥‡∏î GPS"), { enableHighAccuracy: true });
    }
  </script>
</body>
</html>
