<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <meta charset="UTF-8">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="SCIn 2026">

  <link rel="apple-touch-icon" href="https://img.icons8.com/fluent/512/map-marker.png">
  <link rel="icon" href="https://img.icons8.com/fluent/512/map-marker.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <style>
    :root {
      --bg-color: #F7F9F9;
      --card-bg: #FFFFFF;
      --pastel-blue: #D4EBF8;
      --pastel-green: #E1F0DA;
      --pastel-yellow: #FFF9C4;
      --pastel-red: #FFCCBC;
      --pastel-orange: #FFE0B2;
      --accent-blue: #1A73E8;
    }
    body { font-family: 'Segoe UI', Tahoma, sans-serif; padding: 10px; background-color: var(--bg-color); color: #546E7A; text-align: center; margin: 0; }
    .card { background: white; padding: 30px 20px; border-radius: 25px; box-shadow: 0 10px 30px rgba(0,0,0,0.05); max-width: 400px; margin: 20px auto; box-sizing: border-box; }
    
    .pos-btn { display: block; width: 100%; padding: 18px; margin: 12px 0; font-size: 19px; border: none; border-radius: 15px; cursor: pointer; font-weight: bold; color: #546E7A; transition: 0.3s; text-decoration: none; }
    .btn-site { background-color: var(--pastel-blue); }
    .btn-in { background-color: var(--pastel-green); }
    .btn-out { background-color: var(--pastel-yellow); }
    .btn-report { background-color: var(--pastel-red); color: #BF360C; }
    .btn-expense { background-color: var(--pastel-orange); color: #E65100; }
    
    .status-display { font-size: 26px; font-weight: 900; color: var(--accent-blue); background: #E3F2FD; padding: 15px; border-radius: 15px; margin-bottom: 20px; width: 100%; box-sizing: border-box; border: 2px dashed var(--pastel-blue); }
    
    input, select, textarea { width: 100%; padding: 15px; margin-bottom: 15px; border: 1px solid #ECEFF1; border-radius: 12px; box-sizing: border-box; font-size: 16px; outline: none; background: #FAFAFA; font-family: inherit; text-align: center; }
    input:focus, textarea:focus { border-color: var(--accent-blue); background: #FFF; }
    
    .main-btn { padding: 18px; font-size: 18px; width: 100%; cursor: pointer; background-color: #A5D6A7; color: white; border: none; border-radius: 15px; font-weight: bold; box-shadow: 0 4px 15px rgba(165,214,167,0.4); margin-top: 10px; }
    .main-btn:disabled { background-color: #CFD8DC; box-shadow: none; cursor: not-allowed; }
    
    .section-title { font-weight: bold; color: var(--accent-blue); margin-bottom: 15px; text-align: left; }
    .summary-box { text-align: left; background: #f9f9f9; padding: 15px; border-radius: 12px; margin-bottom: 15px; border: 1px solid #eee; line-height: 1.6; }
    
    #page-record, #extra-questions, #report-section, #site-section, #expense-section, #expense-upload, #expense-summary, #finish-msg { display: none; }
    .welcome-msg { font-size: 14px; color: #90A4AE; margin-top: 25px; line-height: 1.6; }
    .safety-msg { font-size: 18px; font-weight: bold; color: #EF5350; margin-top: 10px; }
    .icon-success { font-size: 60px; color: #4CAF50; margin-bottom: 15px; }
  </style>
</head>
<body>

  <div id="page-welcome" class="card">
    <h2 style="color:#78909C;">2026 AEC Check IN</h2>
    <p>‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</p>
    <button type="button" class="pos-btn btn-site" onclick="selectStatus('Site Check In')">üìç Site Check In (‡πÄ‡∏ä‡πá‡∏Ñ‡∏≠‡∏¥‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÑ‡∏ã‡∏ï‡πå)</button>
    <button type="button" class="pos-btn btn-in" onclick="selectStatus('Check In')">üí™ Check In (‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô)</button>
    <button type="button" class="pos-btn btn-out" onclick="selectStatus('Check Out')">üò¥ Check Out (‡πÄ‡∏•‡∏¥‡∏Å‡∏á‡∏≤‡∏ô)</button>
    <button type="button" class="pos-btn btn-report" onclick="selectStatus('Report')">üìù Report (‡∏™‡πà‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô)</button>
    <button type="button" class="pos-btn btn-expense" onclick="selectStatus('Expenses')">üí∞ Expenses (‡πÄ‡∏ö‡∏¥‡∏Å‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢)</button>
  </div>

  <div id="page-record" class="card">
    <div id="display-status" class="status-display">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: </div>
    <div id="status-text" style="margin-bottom:15px; font-weight:bold; color:orange;">‚è≥ ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</div>

    <input type="text" id="userName" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå ‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì (‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏Å‡∏±‡∏ô‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á)">
    
    <select id="userRegion">
      <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î‡∏†‡∏≤‡∏Ñ (‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö) --</option>
      <option value="BKK">BKK</option>
      <option value="CR">CR</option>
      <option value="ER">ER</option>
      <option value="NER">NER</option>
      <option value="NR">NR</option>
      <option value="SR">SR</option>
      <option value="TE">TE</option>
      <option value="DR">DR</option>
      <option value="OFFICE">OFFICE</option>
    </select>

    <div id="extra-questions">
      <input type="text" id="q_with" placeholder="‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Å‡∏±‡∏ö‡πÉ‡∏Ñ‡∏£ (‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô)">
      <select id="q_car" onchange="checkCar()">
        <option value="‡∏£‡∏ñ‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á">‡πÉ‡∏ä‡πâ‡∏£‡∏ñ‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á</option>
        <option value="‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô">‡πÉ‡∏ä‡πâ‡∏£‡∏ñ‡∏Ñ‡∏ô‡∏≠‡∏∑‡πà‡∏ô (‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô)</option>
      </select>
      <input type="text" id="q_car_name" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏£‡∏ñ" style="display:none;">
      <input type="number" id="q_mile" placeholder="‡πÄ‡∏•‡∏Ç‡πÑ‡∏°‡∏•‡πå‡πÄ‡∏ó‡πà‡∏≤‡πÑ‡∏£ (‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô)">
      <select id="q_loc" onchange="checkHotel()">
        <option id="opt_loc_head" value="">‡πÄ‡∏ä‡πá‡∏Ñ‡∏≠‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏´‡∏ô? (‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡πÄ‡∏•‡∏∑‡∏≠‡∏Å)</option>
        <option value="‡∏≠‡∏≠‡∏ü‡∏ü‡∏¥‡∏ï">‡∏≠‡∏≠‡∏ü‡∏ü‡∏¥‡∏ï</option>
        <option id="opt_dynamic" value="‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏û‡∏±‡∏Å">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏û‡∏±‡∏Å</option>
        <option id="opt_hotel" value="‡πÇ‡∏£‡∏á‡πÅ‡∏£‡∏°" style="display:none;">‡πÇ‡∏£‡∏á‡πÅ‡∏£‡∏°</option>
      </select>
      <input type="text" id="q_hotel_prov" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏Ç‡∏≠‡∏á‡πÇ‡∏£‡∏á‡πÅ‡∏£‡∏°" style="display:none;">
      <textarea id="q_plan" rows="3" placeholder="PLAN: ‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏ó‡∏≥‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ (‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏Å‡∏£‡∏≠‡∏Å)"></textarea>
    </div>

    <div id="report-section">
      <select id="q_region">
        <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Region ‡∏á‡∏≤‡∏ô (‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö) --</option>
        <option>BKK</option><option>CR</option><option>ER</option><option>NER</option><option>NR</option><option>SR</option><option>TE</option><option>DR</option>
      </select>
      <input type="text" id="q_buddy" placeholder="‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ñ‡∏π‡πà‡∏Å‡∏±‡∏ö‡πÉ‡∏Ñ‡∏£ (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)">
      <div style="text-align:left; font-weight:bold; color:var(--accent-blue); margin-bottom:5px;">‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà?</div>
      <input type="date" id="q_date_rep">
      <select id="q_type" onchange="document.getElementById('q_type_etc').style.display = (this.value === '‡∏á‡∏≤‡∏ô ‡∏≠‡∏∑‡πà‡∏ô ‡πÜ' ? 'block' : 'none')">
        <option value="">-- ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏á‡∏≤‡∏ô (‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö) --</option>
        <option value="‡∏á‡∏≤‡∏ô CR">‡∏á‡∏≤‡∏ô CR</option><option value="‡∏á‡∏≤‡∏ô OFFICE">‡∏á‡∏≤‡∏ô OFFICE</option><option value="‡∏á‡∏≤‡∏ô TE">‡∏á‡∏≤‡∏ô TE</option><option value="‡∏á‡∏≤‡∏ô DRONE">‡∏á‡∏≤‡∏ô DRONE</option><option value="‡∏á‡∏≤‡∏ô ‡∏≠‡∏∑‡πà‡∏ô ‡πÜ">‡∏á‡∏≤‡∏ô ‡∏≠‡∏∑‡πà‡∏ô ‡πÜ</option>
      </select>
      <input type="text" id="q_type_etc" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏ô‡∏¥‡∏î‡∏á‡∏≤‡∏ô (‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö)" style="display:none;">
      <textarea id="q_job_detail" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏á‡∏≤‡∏ô"></textarea>
    </div>

    <div id="site-section">
      <div id="site-container"></div>
    </div>

    <div id="expense-section">
      <input type="date" id="ex_date">
      <select id="ex_type" onchange="document.getElementById('ex_type_etc').style.display=(this.value==='‡∏á‡∏≤‡∏ô ‡∏≠‡∏∑‡πà‡∏ô ‡πÜ'?'block':'none')">
        <option value="">-- ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏á‡∏≤‡∏ô (‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö) --</option>
        <option>‡∏á‡∏≤‡∏ô CR</option><option>‡∏á‡∏≤‡∏ô OFFICE</option><option>‡∏á‡∏≤‡∏ô TE</option><option>‡∏á‡∏≤‡∏ô DRONE</option><option>‡∏á‡∏≤‡∏ô ‡∏≠‡∏∑‡πà‡∏ô ‡πÜ</option>
      </select>
      <input type="text" id="ex_type_etc" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏ô‡∏¥‡∏î‡∏á‡∏≤‡∏ô" style="display:none;">
      <select id="ex_region">
        <option value="">-- ‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î‡∏†‡∏≤‡∏Ñ (‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö) --</option>
        <option>BKK</option><option>CR</option><option>ER</option><option>NER</option><option>NR</option><option>SR</option><option>TE</option><option>DR</option><option>OFFICE</option>
      </select>
      <input type="text" id="ex_site" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ã‡∏ï‡πå (‡∏£‡∏∞‡∏ß‡∏±‡∏á‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏¥‡∏î)">
      <input type="text" id="ex_prov" placeholder="‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î">
      <input type="number" id="ex_oil" placeholder="‡∏ö‡∏¥‡∏• 1 ‡∏Ñ‡πà‡∏≤‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô‡∏£‡∏ñ‡∏¢‡∏ô‡∏ï‡πå (‡∏ö‡∏≤‡∏ó)">
      <input type="number" id="ex_hotel" placeholder="‡∏ö‡∏¥‡∏• 2 ‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏û‡∏±‡∏Å (‡∏ö‡∏≤‡∏ó)">
      <input type="number" id="ex_ccr" placeholder="‡∏ö‡∏¥‡∏• 3 ‡∏Ñ‡πà‡∏≤‡∏Ç‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏Ñ‡∏° (‡∏ö‡∏≤‡∏ó)">
      <input type="number" id="ex_trav" placeholder="‡∏ö‡∏¥‡∏• 4 ‡∏Ñ‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á (‡∏ö‡∏≤‡∏ó)">
      
      <select id="ex_spc_type" onchange="document.getElementById('ex_spc_val').style.display=(this.value!=='‡πÑ‡∏°‡πà‡∏°‡∏µ'?'block':'none')">
        <option value="‡πÑ‡∏°‡πà‡∏°‡∏µ">-- ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏û‡∏¥‡πÄ‡∏®‡∏© (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ) --</option>
        <option>‡πÄ‡∏ö‡∏¥‡∏Å‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô/‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏µ‡∏°/‡πÄ‡∏á‡∏¥‡∏ô‡∏Å‡∏π‡πâ</option><option>‡∏Ñ‡πà‡∏≤‡∏à‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô</option><option>‡∏Ñ‡πà‡∏≤‡∏à‡πâ‡∏≤‡∏á‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡πÄ‡∏´‡∏°‡∏≤</option><option>‡∏ó‡∏≥‡∏ü‡∏±‡∏ô (‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏¥‡∏Å‡∏≤‡∏£)</option><option>‡∏Ñ‡πà‡∏≤‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏• (‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏¥‡∏Å‡∏≤‡∏£)</option><option>‡∏Ñ‡πà‡∏≤‡∏™‡∏±‡∏ô‡∏ó‡∏ô‡∏≤‡∏Å‡∏≤‡∏£ (‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß)</option><option>‡∏Ç‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</option><option>‡∏Ñ‡πà‡∏≤‡∏†‡∏≤‡∏©‡∏µ/‡∏õ‡∏Å‡∏™.‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó</option>
      </select>
      <input type="number" id="ex_spc_val" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏© (‡∏ö‡∏≤‡∏ó)" style="display:none;">

      <select id="ex_nb_type" onchange="document.getElementById('ex_nb_area').style.display=(this.value!=='‡πÑ‡∏°‡πà‡∏°‡∏µ'?'block':'none')">
        <option value="‡πÑ‡∏°‡πà‡∏°‡∏µ">-- ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ö‡∏¥‡∏• (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ) --</option>
        <option>‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ö‡∏¥‡∏•</option>
      </select>
      <div id="ex_nb_area" style="display:none;">
        <input type="text" id="ex_nb_name" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ö‡∏¥‡∏•">
        <input type="number" id="ex_nb_val" placeholder="‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô (‡∏ö‡∏≤‡∏ó)">
      </div>

      <select id="ex_scr_type" onchange="document.getElementById('ex_scr_area').style.display=(this.value!=='‡πÑ‡∏°‡πà‡∏°‡∏µ'?'block':'none')">
        <option value="‡πÑ‡∏°‡πà‡∏°‡∏µ">-- ‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏ö‡∏¥‡∏Å‡∏Ñ‡πà‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏Ñ‡∏° (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ) --</option>
        <option>‡∏°‡∏µ‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏ö‡∏¥‡∏Å‡∏Ñ‡πà‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏Ñ‡∏°</option>
      </select>
      <div id="ex_scr_area" style="display:none;">
        <div style="text-align:left; font-size:14px; margin-bottom:5px; color:var(--accent-blue);">üìÖ ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏Ñ‡∏° (‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö)</div>
        <input type="date" id="ex_scr_date">
        <input type="text" id="ex_scr_site" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ã‡∏ï‡πå‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏Ñ‡∏° (‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö)">
        <input type="text" id="ex_scr_prov" placeholder="‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏Ñ‡∏° (‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö)">
        <input type="number" id="ex_scr_val" placeholder="‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô (‡∏ö‡∏≤‡∏ó) (‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö)">
      </div>
    </div>

    <div id="expense-upload">
      <div class="section-title">üì∏ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏π‡∏õ‡∏ö‡∏¥‡∏• (‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 10 ‡∏£‡∏π‡∏õ)</div>
      <input type="file" id="ex_files" accept="image/*" multiple onchange="validateFiles(this)">
      <div id="file-list" style="color:green; font-size:12px; margin-bottom:15px; margin-top:-10px;"></div>
    </div>

    <div id="expense-summary">
      <div class="section-title">üìä ‡∏™‡∏£‡∏∏‡∏õ‡∏¢‡∏≠‡∏î‡πÄ‡∏ö‡∏¥‡∏Å‡∏à‡πà‡∏≤‡∏¢</div>
      <div id="sum-details" class="summary-box"></div>
      <div id="sum-total" style="font-size:22px; font-weight:bold; color:#2e7d32; margin-bottom:20px;"></div>
      <div style="display:flex; gap:10px;">
        <button type="button" class="main-btn" style="background:#888;" onclick="expenseStep=1; renderExpenseStep()">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>
        <button type="button" class="main-btn" style="background:#2e7d32;" onclick="confirmExpenseFinal()">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
      </div>
    </div>

    <button type="button" id="btn-action" class="main-btn" onclick="handleFlow()">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏û‡∏¥‡∏Å‡∏±‡∏î‡πÅ‡∏•‡∏∞‡∏ñ‡πà‡∏≤‡∏¢‡∏£‡∏π‡∏õ</button>

    <div id="finish-msg">
      <div class="icon-success"><i class="fas fa-check-circle"></i></div>
      <div style="font-size: 24px; font-weight: bold; color: #4CAF50; margin-bottom: 10px;">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß</div>
      <div id="finish-text-1" class="welcome-msg"></div>
      <div id="finish-text-2" class="safety-msg"></div>
      <button type="button" class="main-btn" onclick="location.reload()" style="background:#1A73E8; margin-top:20px;">‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</button>
    </div>
  </div>

  <input type="file" id="fileInput" accept="image/*" capture="camera" style="display:none" onchange="uploadPhoto(this)">

<script>
  const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbwk-spmOFdk-ZLRHhTkJXUshNWmJ6DqvdbNqUByszqLMDVujm7XFe0by-VDVUmNgZmuoQ/exec";
  var selectedStatus = "";
  var currentRow = 0;
  var reportStep = 1; 
  var siteIdx = 1;
  var expenseStep = 1;
  var selectedFiles = [];

  function checkCar() {
    var carOpt = document.getElementById('q_car').value;
    document.getElementById('q_car_name').style.display = (carOpt == "‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô") ? "block" : "none";
  }

  function checkHotel() {
    var locVal = document.getElementById('q_loc').value;
    document.getElementById('q_hotel_prov').style.display = (locVal == "‡πÇ‡∏£‡∏á‡πÅ‡∏£‡∏°") ? "block" : "none";
  }

  function selectStatus(status) {
    selectedStatus = status;
    document.getElementById('page-welcome').style.display = 'none';
    document.getElementById('page-record').style.display = 'block';
    document.getElementById('display-status').innerText = "‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: " + status;
    document.getElementById('extra-questions').style.display = 'none';
    document.getElementById('report-section').style.display = 'none';
    document.getElementById('site-section').style.display = 'none';
    document.getElementById('expense-section').style.display = 'none';
    document.getElementById('expense-upload').style.display = 'none';
    document.getElementById('expense-summary').style.display = 'none';
    document.getElementById('btn-action').style.display = 'block';

    if (status === 'Report') {
      document.getElementById('report-section').style.display = 'block';
      document.getElementById('btn-action').innerText = "‡∏™‡πà‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô / ‡πÑ‡∏õ‡∏ï‡πà‡∏≠";
    } else if (status === 'Expenses') {
      expenseStep = 1;
      renderExpenseStep();
    } else {
      if (status === 'Site Check In') {
        document.getElementById('btn-action').innerText = "‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏û‡∏¥‡∏Å‡∏±‡∏î‡πÅ‡∏•‡∏∞‡∏ñ‡πà‡∏≤‡∏¢‡∏£‡∏π‡∏õ";
      } else {
        document.getElementById('extra-questions').style.display = 'block';
        document.getElementById('btn-action').innerText = "‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏û‡∏¥‡∏Å‡∏±‡∏î‡πÅ‡∏•‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏π‡∏õ‡πÄ‡∏•‡∏Ç‡πÑ‡∏°‡∏•‡πå";
        const qLocHead = document.getElementById('opt_loc_head');
        const optDynamic = document.getElementById('opt_dynamic');
        const optHotel = document.getElementById('opt_hotel');
        const qPlan = document.getElementById('q_plan');
        if (status === 'Check In') {
          qLocHead.innerText = "‡πÄ‡∏ä‡πá‡∏Ñ‡∏≠‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏´‡∏ô? (‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡πÄ‡∏•‡∏∑‡∏≠‡∏Å)"; optDynamic.innerText = "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏û‡∏±‡∏Å"; optDynamic.value = "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏û‡∏±‡∏Å"; optHotel.style.display = "none"; qPlan.placeholder = "PLAN: ‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏ó‡∏≥‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ (‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏Å‡∏£‡∏≠‡∏Å)";
        } else {
          qLocHead.innerText = "‡πÄ‡∏ä‡πá‡∏Ñ‡πÄ‡∏≠‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÑ‡∏´‡∏ô? (‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡πÄ‡∏•‡∏∑‡∏≠‡∏Å)"; optDynamic.innerText = "‡∏ö‡πâ‡∏≤‡∏ô"; optDynamic.value = "‡∏ö‡πâ‡∏≤‡∏ô"; optHotel.style.display = "block"; qPlan.placeholder = "BRIFE: ‡∏™‡∏£‡∏∏‡∏õ‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏™‡∏±‡πâ‡∏ô ‡πÜ (‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏Å‡∏£‡∏≠‡∏Å)";
        }
      }
    }
  }

  function handleFlow() {
    if (selectedStatus === 'Report') processReport();
    else if (selectedStatus === 'Expenses') processExpense();
    else getGPS();
  }

  function renderExpenseStep() {
    document.getElementById('expense-section').style.display = (expenseStep === 1 ? 'block' : 'none');
    document.getElementById('expense-upload').style.display = (expenseStep === 2 ? 'block' : 'none');
    document.getElementById('expense-summary').style.display = (expenseStep === 3 ? 'block' : 'none');
    document.getElementById('btn-action').style.display = (expenseStep === 3 ? 'none' : 'block');
    document.getElementById('btn-action').innerText = (expenseStep === 1 ? "‡∏ñ‡∏±‡∏î‡πÑ‡∏õ: ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏π‡∏õ‡∏ö‡∏¥‡∏•" : "‡∏™‡∏£‡∏∏‡∏õ‡∏¢‡∏≠‡∏î‡πÄ‡∏ö‡∏¥‡∏Å‡∏à‡πà‡∏≤‡∏¢");
  }

  function validateFiles(input) {
    selectedFiles = Array.from(input.files);
    if(selectedFiles.length > 10) { alert("‡∏´‡πâ‡∏≤‡∏°‡πÄ‡∏Å‡∏¥‡∏ô 10 ‡∏£‡∏π‡∏õ‡∏Ñ‡∏£‡∏±‡∏ö"); input.value=""; return; }
    document.getElementById('file-list').innerText = "‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß " + selectedFiles.length + " ‡∏£‡∏π‡∏õ";
  }

  function processExpense() {
    if(!document.getElementById('userName').value) { alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô‡∏Ñ‡∏£‡∏±‡∏ö"); return; }
    if(!document.getElementById('userRegion').value) { alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î‡∏†‡∏≤‡∏Ñ‡∏Ñ‡∏£‡∏±‡∏ö"); return; }
    if(expenseStep === 1) {
      if(!document.getElementById('ex_date').value || !document.getElementById('ex_region').value) { alert("‡∏Å‡∏£‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏•‡∏∞‡∏†‡∏≤‡∏Ñ‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö"); return; }
      if(document.getElementById('ex_scr_type').value === '‡∏°‡∏µ‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏ö‡∏¥‡∏Å‡∏Ñ‡πà‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏Ñ‡∏°') {
        if(!document.getElementById('ex_scr_date').value || !document.getElementById('ex_scr_site').value || !document.getElementById('ex_scr_prov').value || !document.getElementById('ex_scr_val').value) {
          alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏ö‡∏¥‡∏Å‡∏Ñ‡πà‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏Ñ‡∏°‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏ä‡πà‡∏≠‡∏á"); return;
        }
      }
      expenseStep = 2; renderExpenseStep();
    } else if(expenseStep === 2) {
      if(selectedFiles.length === 0) { alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏π‡∏õ‡∏ö‡∏¥‡∏•‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 1 ‡∏£‡∏π‡∏õ"); return; }
      showSummary();
    }
  }

  function showSummary() {
    expenseStep = 3; renderExpenseStep();
    var oil = parseFloat(document.getElementById('ex_oil').value || 0);
    var hotel = parseFloat(document.getElementById('ex_hotel').value || 0);
    var ccr = parseFloat(document.getElementById('ex_ccr').value || 0);
    var trav = parseFloat(document.getElementById('ex_trav').value || 0);
    var spc = parseFloat(document.getElementById('ex_spc_val').value || 0);
    var nb = parseFloat(document.getElementById('ex_nb_val').value || 0);
    var scr = parseFloat(document.getElementById('ex_scr_val').value || 0);
    var total = oil + hotel + ccr + trav + spc + nb + scr;
    var html = "";
    if(oil > 0) html += "‚õΩ ‡∏Ñ‡πà‡∏≤‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô: " + oil + " ‡∏ö‡∏≤‡∏ó<br>";
    if(hotel > 0) html += "üè® ‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏û‡∏±‡∏Å: " + hotel + " ‡∏ö‡∏≤‡∏ó<br>";
    if(ccr > 0) html += "üç™ ‡∏Ñ‡πà‡∏≤‡∏Ç‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏Ñ‡∏°: " + ccr + " ‡∏ö‡∏≤‡∏ó<br>";
    if(trav > 0) html += "üöó ‡∏Ñ‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á: " + trav + " ‡∏ö‡∏≤‡∏ó<br>";
    if(spc > 0) html += "‚ú® ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏û‡∏¥‡πÄ‡∏®‡∏©: " + spc + " ‡∏ö‡∏≤‡∏ó<br>";
    if(nb > 0) html += "üìù ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ö‡∏¥‡∏•: " + nb + " ‡∏ö‡∏≤‡∏ó (" + document.getElementById('ex_nb_name').value + ")<br>";
    if(scr > 0) html += "üì¢ ‡∏Ñ‡πà‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏Ñ‡∏°: " + scr + " ‡∏ö‡∏≤‡∏ó (‡πÑ‡∏ã‡∏ï‡πå " + document.getElementById('ex_scr_site').value + ")<br>";
    document.getElementById('sum-details').innerHTML = html || "‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏ö‡∏¥‡∏Å‡πÄ‡∏á‡∏¥‡∏ô";
    document.getElementById('sum-total').innerText = "‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏¥‡πâ‡∏ô: " + total.toLocaleString() + " ‡∏ö‡∏≤‡∏ó";
  }

  function confirmExpenseFinal() {
    document.getElementById('status-text').innerText = "üîÑ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡∏∞‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ...";
    document.getElementById('expense-summary').style.display = 'none';
    var d = new Array(57).fill("");
    d[0] = document.getElementById('ex_date').value;
    d[2] = document.getElementById('userName').value;
    d[7] = "Expenses";
    d[14] = document.getElementById('userRegion').value; // ‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î‡∏†‡∏≤‡∏Ñ‡∏•‡∏á Column O
    d[15] = document.getElementById('ex_type').value;
    d[16] = document.getElementById('ex_type_etc').value;
    d[42] = document.getElementById('ex_site').value;
    d[43] = document.getElementById('ex_prov').value;
    d[44] = document.getElementById('ex_oil').value || 0;
    d[45] = document.getElementById('ex_hotel').value || 0;
    d[46] = document.getElementById('ex_ccr').value || 0;
    d[47] = document.getElementById('ex_trav').value || 0;
    d[48] = document.getElementById('ex_spc_type').value;
    d[49] = document.getElementById('ex_spc_val').value || 0;
    d[50] = document.getElementById('ex_nb_name').value || "‡πÑ‡∏°‡πà‡∏°‡∏µ";
    d[51] = document.getElementById('ex_nb_val').value || 0;
    d[52] = document.getElementById('ex_scr_type').value;
    d[53] = document.getElementById('ex_scr_site').value || ""; 
    d[54] = document.getElementById('ex_scr_prov').value || ""; 
    d[55] = document.getElementById('ex_scr_val').value || 0;  
    d[56] = document.getElementById('ex_scr_date').value || "";
    d[57] = document.getElementById('ex_date').value; // EPSDate ‡∏•‡∏á Column BE (Index 56+1)

    var promises = selectedFiles.map(file => {
      return new Promise(resolve => {
        var reader = new FileReader();
        reader.onload = e => resolve({name: file.name, data: e.target.result});
        reader.readAsDataURL(file);
      });
    });

    Promise.all(promises).then(files => {
      fetch(WEB_APP_URL, {
        method: "POST",
        mode: "no-cors",
        body: JSON.stringify({
          action: "SAVE_EXPENSE_FILES",
          values: d,
          files: files,
          region: document.getElementById('userRegion').value // ‡πÅ‡∏¢‡∏Å Folder ‡∏ï‡∏≤‡∏°‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î‡∏†‡∏≤‡∏Ñ
        })
      }).then(finishDisplay);
    });
  }

  function processReport() {
    var name = document.getElementById('userName').value;
    var region = document.getElementById('userRegion').value;
    if (!name || !region) { alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏•‡∏∞‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î‡∏†‡∏≤‡∏Ñ‡∏Ñ‡∏£‡∏±‡∏ö"); return; }
    if (reportStep === 1) {
      var reportDate = document.getElementById('q_date_rep').value;
      if(!document.getElementById('q_region').value || !reportDate || !document.getElementById('q_type').value) { alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏Ñ‡∏£‡∏±‡∏ö"); return; }
      if (new Date(reportDate).getFullYear() !== 2026) { alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ô‡∏õ‡∏µ 2026 ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô‡∏Ñ‡∏£‡∏±‡∏ö"); return; }
      if(document.getElementById('q_type').value === '‡∏á‡∏≤‡∏ô CR') {
        reportStep = 2; siteIdx = 1; document.getElementById('site-container').innerHTML = ''; renderSite(1);
      } else {
        if(!document.getElementById('q_job_detail').value) { alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏á‡∏≤‡∏ô‡∏Ñ‡∏£‡∏±‡∏ö"); return; }
        sendReportFinal();
      }
    } else {
      if(!validateSite(siteIdx)) return;
      var nextEl = document.getElementById("next_s_" + siteIdx);
      if(siteIdx < 4 && nextEl && nextEl.value.includes("‡∏°‡∏µ‡πÑ‡∏ã‡∏ï‡πå‡∏ó‡∏µ‡πà")) {
        siteIdx++; renderSite(siteIdx);
      } else { sendReportFinal(); }
    }
  }

  function renderSite(n) {
    document.getElementById('report-section').style.display = 'none';
    document.getElementById('site-section').style.display = 'block';
    document.getElementById('btn-action').innerText = (n === 4) ? "‡∏™‡πà‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô" : "‡∏ñ‡∏±‡∏î‡πÑ‡∏õ / ‡∏™‡πà‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô";
    for(var j=1; j<n; j++){ if(document.getElementById('site_wrapper_' + j)) document.getElementById('site_wrapper_' + j).style.display = 'none'; }
    var container = document.getElementById('site-container');
    var div = document.createElement('div');
    div.id = 'site_wrapper_' + n;
    div.innerHTML = `<div class="section-title">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏ã‡∏ï‡πå‡∏ó‡∏µ‡πà ${n}</div>
      ${n === 1 ? `<select id="s_region_job"><option value="">-- ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏†‡∏≤‡∏Ñ --</option><option>BKK</option><option>CR</option><option>ER</option><option>NER</option><option>NR</option><option>SR</option></select>` : ''}
      <input type="text" id="s_name_${n}" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ã‡∏ï‡πå">
      <input type="text" id="s_prov_${n}" placeholder="‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î">
      <select id="s_job_${n}" onchange="document.getElementById('s_etc_${n}').style.display = (this.value === '‡∏≠‡∏∑‡πà‡∏ô ‡πÜ' ? 'block' : 'none')">
        <option value="">-- ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏á‡∏≤‡∏ô --</option>
        <option>‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏•‡∏á‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà ‡πÇ‡∏ó‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏ô‡∏±‡∏î‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏Ñ‡∏°</option>
        <option>‡∏•‡∏á‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏≥ CR - CRL</option>
        <option>‡∏•‡∏á‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏≥ CR + ‡∏ô‡∏±‡∏î‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏Ñ‡∏°</option>
        <option>‡∏•‡∏á‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà ‡∏ó‡∏≥‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏Ñ‡∏°</option>
        <option>‡∏•‡∏á‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏≥ CR + ‡∏ó‡∏≥‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏Ñ‡∏°</option>
        <option>‡∏•‡∏á‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏´‡∏≤‡∏ó‡∏µ‡πà SA</option>
        <option>‡∏•‡∏á‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà ‡πÄ‡∏Ñ‡∏•‡∏µ‡∏¢‡∏£‡πå‡∏õ‡∏£‡∏∞‡πÄ‡∏î‡πá‡∏ô (‡∏Ç‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß)</option>
        <option>‡∏≠‡∏∑‡πà‡∏ô ‡πÜ</option>
      </select>
      <input type="text" id="s_etc_${n}" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏ô‡∏¥‡∏î‡∏á‡∏≤‡∏ô (‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö)" style="display:none;">
      <textarea id="s_det_${n}" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏á‡∏≤‡∏ô"></textarea>
      <input type="text" id="s_ld_${n}" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏ô‡∏≥-‡πÅ‡∏•‡∏∞‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£">
      ${n < 4 ? `<select id="next_s_${n}"><option value="‡πÑ‡∏°‡πà‡∏°‡∏µ">‡πÑ‡∏°‡πà‡∏°‡∏µ (‡∏™‡πà‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô)</option><option value="‡∏°‡∏µ‡πÑ‡∏ã‡∏ï‡πå‡∏ó‡∏µ‡πà ${n+1}">‡∏°‡∏µ‡πÑ‡∏ã‡∏ï‡πå‡∏ó‡∏µ‡πà ${n+1}</option></select>` : ''}`;
    container.appendChild(div);
  }

  function validateSite(n) {
    var job = document.getElementById(`s_job_${n}`).value;
    var etc = document.getElementById(`s_etc_${n}`).value;
    if(!document.getElementById(`s_name_${n}`).value || !document.getElementById(`s_prov_${n}`).value || !job || !document.getElementById(`s_det_${n}`).value || !document.getElementById(`s_ld_${n}`).value) { alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏ã‡∏ï‡πå‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô"); return false; }
    if(job === '‡∏≠‡∏∑‡πà‡∏ô ‡πÜ' && !etc) { alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏ô‡∏¥‡∏î‡∏á‡∏≤‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö"); return false; }
    return true;
  }

  function sendReportFinal() {
    document.getElementById('btn-action').disabled = true;
    document.getElementById('status-text').innerText = "üîÑ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô...";
    var d = new Array(42).fill("");
    d[0] = document.getElementById('q_date_rep').value;
    d[2] = document.getElementById('userName').value;
    d[7] = "Report";
    d[9] = document.getElementById('q_buddy').value;
    d[14] = document.getElementById('userRegion').value; // ‡∏•‡∏á Column O
    d[15] = document.getElementById('q_type').value;
    d[17] = document.getElementById('q_job_detail').value;
    if(d[15] === '‡∏á‡∏≤‡∏ô CR') {
      d[17] = document.getElementById('s_region_job').value;
      for(var i=1; i <= siteIdx; i++) {
        var base = 18 + ((i-1)*6);
        d[base] = document.getElementById('s_name_' + i).value; 
        d[base+1] = document.getElementById('s_prov_' + i).value; 
        d[base+2] = document.getElementById('s_job_' + i).value;
        d[base+3] = document.getElementById('s_etc_' + i).value || ""; 
        d[base+4] = document.getElementById('s_det_' + i).value; 
        d[base+5] = document.getElementById('s_ld_' + i).value;
      }
    }
    fetch(WEB_APP_URL, { method: "POST", mode: "no-cors", body: JSON.stringify({ action: "SAVE_REPORT", values: d })}).then(finishDisplay);
  }

  function getGPS() {
    var name = document.getElementById('userName').value;
    var region = document.getElementById('userRegion').value;
    if (!name || !region) { alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏•‡∏∞‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î‡∏†‡∏≤‡∏Ñ‡∏Ñ‡∏£‡∏±‡∏ö"); return; }
    
    var q_loc = document.getElementById('q_loc').value;
    var q_plan = document.getElementById('q_plan').value;
    
    if(selectedStatus === 'Check In' || selectedStatus === 'Check Out') {
       if(!q_loc) { alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà " + (selectedStatus === 'Check In' ? "‡πÄ‡∏ä‡πá‡∏Ñ‡∏≠‡∏¥‡∏ô" : "‡πÄ‡∏ä‡πá‡∏Ñ‡πÄ‡∏≠‡πâ‡∏≤") + " ‡∏Ñ‡∏£‡∏±‡∏ö"); return; }
       if(!q_plan) { alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å " + (selectedStatus === 'Check In' ? "PLAN" : "BRIFE") + " ‡∏Ñ‡∏£‡∏±‡∏ö"); return; }
    }

    document.getElementById('status-text').innerText = "‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏û‡∏¥‡∏Å‡∏±‡∏î...";
    document.getElementById('btn-action').disabled = true;
    navigator.geolocation.getCurrentPosition(function(pos) {
      window.tempData = [name, pos.coords.latitude, pos.coords.longitude, selectedStatus, "Mobile"];
      document.getElementById('status-text').innerText = "üìç ‡∏û‡∏ö‡∏û‡∏¥‡∏Å‡∏±‡∏î‡πÅ‡∏•‡πâ‡∏ß! ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ñ‡πà‡∏≤‡∏¢‡∏£‡∏π‡∏õ";
      document.getElementById('fileInput').click();
    }, function(err) { alert("Error GPS: " + err.message); document.getElementById('btn-action').disabled = false; }, {enableHighAccuracy: true});
  }

  function uploadPhoto(input) {
    if (!input || !input.files[0]) return;
    document.getElementById('status-text').innerText = "üîÑ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...";
    var reader = new FileReader();
    reader.onload = function(e) {
      var finalLoc = document.getElementById('q_loc').value;
      if(finalLoc === "‡πÇ‡∏£‡∏á‡πÅ‡∏£‡∏°") finalLoc = "‡πÇ‡∏£‡∏á‡πÅ‡∏£‡∏° (" + document.getElementById('q_hotel_prov').value + ")";
      var finalCar = (document.getElementById('q_car').value === "‡∏£‡∏ñ‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á") ? document.getElementById('userName').value : (document.getElementById('q_car_name').value || "‡∏Ñ‡∏ô‡∏≠‡∏∑‡πà‡∏ô");
      
      // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô 15 ‡∏ä‡πà‡∏≠‡∏á‡πÅ‡∏£‡∏Å
      var basicData = new Array(15).fill("");
      basicData[0] = new Date().toLocaleDateString('th-TH'); // ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ
      basicData[2] = window.tempData[0]; // ‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô
      basicData[3] = window.tempData[1]; // Lat
      basicData[4] = window.tempData[2]; // Lng
      basicData[7] = window.tempData[3]; // Status
      basicData[14] = document.getElementById('userRegion').value; // Region ‡∏•‡∏á Column O

      var extraData = [ 
        document.getElementById('q_with').value || "-", 
        finalCar, 
        document.getElementById('q_mile').value || "0", 
        finalLoc || "-", 
        document.getElementById('q_plan').value || "-" 
      ];
      
      fetch(WEB_APP_URL, {
        method: "POST",
        mode: "no-cors",
        body: JSON.stringify({
          action: "GET_LOC",
          values: basicData, // ‡∏™‡πà‡∏á‡∏≠‡∏≤‡πÄ‡∏£‡∏¢‡πå 15 ‡∏ä‡πà‡∏≠‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏ä‡∏∑‡πà‡∏≠‡∏†‡∏≤‡∏Ñ‡∏•‡∏á Column O
          extra: extraData,
          image: e.target.result,
          region: document.getElementById('userRegion').value // ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏¢‡∏Å‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏£‡∏π‡∏õ
        })
      }).then(finishDisplay);
    };
    reader.readAsDataURL(input.files[0]);
  }

  function finishDisplay() {
    document.getElementById('finish-msg').style.display = "block";
    document.getElementById('btn-action').style.display = "none";
    document.getElementById('userName').style.display = "none";
    document.getElementById('userRegion').style.display = "none";
    document.getElementById('extra-questions').style.display = "none";
    document.getElementById('report-section').style.display = "none";
    document.getElementById('site-section').style.display = "none";
    document.getElementById('expense-section').style.display = "none";
    document.getElementById('expense-upload').style.display = "none";
    document.getElementById('expense-summary').style.display = "none";
    document.getElementById('display-status').style.display = "none";
    document.getElementById('status-text').style.display = "none";
    
    if (selectedStatus === 'Check Out' || selectedStatus === 'Report' || selectedStatus === 'Expenses') {
      document.getElementById('finish-text-1').innerText = "‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡πÉ‡∏´‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πà‡∏ß‡∏°‡∏°‡∏∑‡∏≠ ‡πÅ‡∏ö‡πà‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏Å‡∏ú‡πà‡∏≠‡∏ô‡πÉ‡∏´‡πâ‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠ ‡∏≠‡∏¢‡πà‡∏≤‡∏•‡∏∑‡∏°‡∏™‡πà‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô ‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏ö‡∏¥‡∏Å‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏î‡πâ‡∏ß‡∏¢‡∏ô‡∏∞";
      document.getElementById('finish-text-2').innerText = "Take care and Sleep well.";
    } else {
      document.getElementById('finish-text-1').innerText = "‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡πÉ‡∏´‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πà‡∏ß‡∏°‡∏°‡∏∑‡∏≠ ‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏ô‡∏∏‡∏Å‡∏™‡∏ô‡∏≤‡∏ô ‡∏Ñ‡∏¥‡∏î‡∏ñ‡∏∂‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏•‡∏±‡∏Å ‡πÄ‡∏Ñ‡∏≤‡∏£‡∏û‡πÅ‡∏•‡∏∞‡πÉ‡∏´‡πâ‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡∏ï‡∏¥‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÅ‡∏•‡∏∞‡∏£‡πà‡∏ß‡∏°‡∏á‡∏≤‡∏ô";
      document.getElementById('finish-text-2').innerText = "Safety First and Have a nice day";
    }
  }
</script>
</body>
</html>
